<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.1.1">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Mist","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="Leoolin">
<meta property="og:url" content="http://example.com/page/2/index.html">
<meta property="og:site_name" content="Leoolin">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="林辰">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://example.com/page/2/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'en'
  };
</script>

  <title>Leoolin</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Leoolin</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/06/02/%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="林辰">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Leoolin">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/06/02/%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89/" class="post-title-link" itemprop="url">汇编语言学习笔记（二）</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2021-06-02 22:26:11 / Modified: 23:41:22" itemprop="dateCreated datePublished" datetime="2021-06-02T22:26:11+08:00">2021-06-02</time>
            </span>

          
            <span id="/2021/06/02/%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89/" class="post-meta-item leancloud_visitors" data-flag-title="汇编语言学习笔记（二）" title="Views">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">Views: </span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/2021/06/02/%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2021/06/02/%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="2-9-段寄存器"><a href="#2-9-段寄存器" class="headerlink" title="2.9 段寄存器"></a>2.9 段寄存器</h2><p>段地址存储在段寄存器</p>
<blockquote>
<p>8086CPU有4个段寄存器</p>
<p>CS、DS、SS、ES</p>
</blockquote>
<p>当8086CPU要访问内存时，由这4个段寄存器提供内存单元的段地址</p>
<h2 id="2-10-CS和IP"><a href="#2-10-CS和IP" class="headerlink" title="2.10 CS和IP"></a>2.10 CS和IP</h2><p>CS和IP是8086CPU中最关键的寄存器，他们指示当前要读取指令的地址。</p>
<p>CS：代码段寄存器</p>
<p>IP：指令指针寄存器</p>
<ol>
<li>从CS:IP指向内存单元读取指令，读取的指令进入指令缓存器；</li>
<li>IP = IP + 所读取指令的长度，从而指向下一条指令；</li>
<li>执行指令。转到步骤1，重复这个过程。</li>
</ol>
<blockquote>
<p>8086PC工作过程的简要描述</p>
<ul>
<li>在8086CPU加电或复位后（CPU刚开始工作时）CP和IP被设置为CS=FFFFH，IP=0000H。</li>
<li>即在8086PC机刚启动时，CPU从内存FFFF0H单元中读取指令执行。</li>
<li>FFFF0H单元中的指令是8086PC机开机后执行的第一条指令。</li>
</ul>
</blockquote>
<ul>
<li>在任何时候，CPU将CS、IP中的内容当作指令的段地址和偏移地址，用它们合成指令的物理地址，到内存中读取指令码，再执行。</li>
</ul>
<ul>
<li>如果说，内存中的一段信息曾被CPU执行过，那么它所在的内存单元必然被CS:IP指向过。</li>
</ul>
<h2 id="2-11-修改CS、IP的指令"><a href="#2-11-修改CS、IP的指令" class="headerlink" title="2.11 修改CS、IP的指令"></a>2.11 修改CS、IP的指令</h2><ul>
<li>在CPU中，程序员能够用指令读写的部件只有寄存器，程序员可以通过改变寄存器中的内容实现对CPU的控制。</li>
<li>CPU从何处执行指令是由CS、IP中的内容决定的，程序员可以通过改变CS、IP中的内容来控制CPU执行目标指令。</li>
</ul>
<blockquote>
<p>如何修改AX中的值？</p>
<p>mov指令可以改变8086CPU大部分寄存器的值：传送指令</p>
<ul>
<li>mov指令不能用于设置CS、IP的值，8086CPU没有提供这样的功能</li>
</ul>
</blockquote>
<ul>
<li><p>jmp段地址：偏移地址</p>
<p>同时修改CS、IP的内容</p>
<blockquote>
<p>功能：用指令中给出的段地址修改CS，偏移地址修改IP。</p>
</blockquote>
<p>jmp 2AE3:3 &gt;&gt; 2AE33H</p>
<p>jmp 3:0B16 &gt;&gt; 0B46H</p>
</li>
<li><p>仅修改IP的内容</p>
<p>jmp某一合法寄存器</p>
<p>jmp ax （类似于mov IP, ax）</p>
<blockquote>
<p>功能：用寄存器中的值修改IP</p>
</blockquote>
</li>
</ul>
<p>问题分析：CPU运行的流程</p>
<p>（初始：CS=2000H，IP=0000H）</p>
<p><img src="/2021/06/02/%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89/1.png" alt="截屏2021-06-02 下午11.08.40"></p>
<ol>
<li>mov ax, 6622H    ;ax=6622H</li>
<li>jmp 1000:3      ;CS=1000,IP=3</li>
<li>mov ax,0000  ;ax=0000H</li>
<li>mov bx,ax   ;bx=0000H</li>
<li>jum bx ;IP=0000H</li>
<li>mov ax,0123H ;ax=0123H</li>
<li>转到第三步执行（死循环 ）</li>
</ol>
<h2 id="2-12-代码段"><a href="#2-12-代码段" class="headerlink" title="2.12 代码段"></a>2.12 代码段</h2><p>对于8086PC机，可以将长度为N(N&lt;=64kb)的一组代码，存在一组地址连续、起始地址为16的倍数的内存单元，这段内存是用来存放代码的，从而定义了一个代码段。</p>
<p>例如：</p>
<p>这段长度为10字节的字节的指令，存在从123B0H<del>123B9H的一组内存单元中，我们就可以认为，123B0H</del>123B9H这段内存单元是用来存放代码的，是一个代码段，它的段地址为123BH，长度为10字节。</p>
<p><img src="/2021/06/02/%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89/2.png" alt="截屏2021-06-02 下午11.24.18"></p>
<h2 id="检测点2-3："><a href="#检测点2-3：" class="headerlink" title="检测点2.3："></a>检测点2.3：</h2><blockquote>
<p>下面的3条指令执行后，CPU几次修改IP？都是什么时候？最后IP中的值是多少？</p>
<p>mov ax,bx</p>
<p>sub ax, ax</p>
<p>jmp ax</p>
</blockquote>
<p>4次（第三次：读取jmp ax之后；第四次：执行jmp ax修改IP）, ax=0000H，IP=ax；</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/06/02/C-Primer%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="林辰">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Leoolin">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/06/02/C-Primer%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89/" class="post-title-link" itemprop="url">C++ Primer学习笔记（二）</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2021-06-02 10:06:54 / Modified: 19:24:51" itemprop="dateCreated datePublished" datetime="2021-06-02T10:06:54+08:00">2021-06-02</time>
            </span>

          
            <span id="/2021/06/02/C-Primer%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89/" class="post-meta-item leancloud_visitors" data-flag-title="C++ Primer学习笔记（二）" title="Views">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">Views: </span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/2021/06/02/C-Primer%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2021/06/02/C-Primer%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="指向指针的指针"><a href="#指向指针的指针" class="headerlink" title="指向指针的指针"></a>指向指针的指针</h1><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> ival = <span class="number">1024</span>;</span><br><span class="line"><span class="keyword">int</span> *pi = &amp;ival; <span class="comment">// pi points to an int</span></span><br><span class="line"><span class="keyword">int</span> **ppi = &amp;pi; <span class="comment">// ppi points to a pointer to an int</span></span><br></pre></td></tr></table></figure>

<p><img src="/2021/06/02/C-Primer%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89/1.png" alt="截屏2021-06-02 上午10.14.16"></p>
<h1 id="指向指针的引用"><a href="#指向指针的引用" class="headerlink" title="指向指针的引用"></a>指向指针的引用</h1><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> i = <span class="number">42</span>;</span><br><span class="line"><span class="keyword">int</span> *p;<span class="comment">//p isa pointer to int </span></span><br><span class="line"><span class="keyword">int</span> *&amp;r = p;<span class="comment">// r is a reference to the pointer p</span></span><br><span class="line">r = &amp;i; <span class="comment">// r refers to a pointer; assigning &amp;i to r makes p point to i</span></span><br><span class="line">*r = <span class="number">0</span>; <span class="comment">// dereferencing r yields i, the object to which p points; changes i to 0</span></span><br></pre></td></tr></table></figure>

<ul>
<li><p>如何理解<code>int *&amp;r = p;</code>？</p>
<p>从右往左看，最靠近<code>r</code>的是<code>&amp;</code>，说明<code>r</code>是一个引用，然后是<code>*</code>，说明<code>r</code>指向指针，最后是<code>int</code>，说明r是一个指向int类型指针的引用。</p>
</li>
</ul>
<blockquote>
<p><strong>Exercises Section 2.3.3<br>Exercise 2.25:</strong> Determine the types and values of each of the following variables.</p>
<p><strong>(a)</strong> int* ip, &amp;r = ip;</p>
<p><strong>(b)</strong> int i, *ip = 0; </p>
<p><strong>(c)</strong> int* ip, ip2;</p>
<p>(a) ip：int类型的指针,r：指向int类型指针的引用</p>
<p>(b) i：int类型的变量，ip：int类型的指针</p>
<p>(c)ip：int类型的指针，ip2：int类型的变量</p>
</blockquote>
<h1 id="常量限定符（const）"><a href="#常量限定符（const）" class="headerlink" title="常量限定符（const）"></a>常量限定符（const）</h1><ul>
<li>const修饰的对象不可修改</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> bufSize = <span class="number">512</span>; <span class="comment">// input buffer size</span></span><br><span class="line">bufSize = <span class="number">512</span>; <span class="comment">// error: attempt to write to const object</span></span><br></pre></td></tr></table></figure>

<ul>
<li>const修饰的对象必须初始化</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> i = get_size(); <span class="comment">// ok: initialized at run time</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> j = <span class="number">42</span>; <span class="comment">// ok: initialized at compile time </span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> k; <span class="comment">// error: k is uninitialized const</span></span><br></pre></td></tr></table></figure>

<ul>
<li>在多个文件中使用const修饰的对象</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// file_1.cc defines and initializes a const that is accessible to other files </span></span><br><span class="line"><span class="keyword">extern</span> <span class="keyword">const</span> <span class="keyword">int</span> bufSize = fcn();</span><br><span class="line"><span class="comment">// file_1.h</span></span><br><span class="line"><span class="keyword">extern</span> <span class="keyword">const</span> <span class="keyword">int</span> bufSize; <span class="comment">// same bufSize as defined in file_1.cc</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>Exercises Section 2.4<br> Exercise 2.26:</strong> Which of the following are legal? For those that are illegal,</p>
<p>explain why.</p>
<p><strong>(a)</strong> const int buf;</p>
<p><strong>(b)</strong> int cnt = 0;</p>
<p><strong>(c)</strong> const int sz = cnt; </p>
<p><strong>(d)</strong> ++cnt; ++sz;</p>
<p>(a)：❌ (d)：++cnt;（✅）++sz;（❌)</p>
</blockquote>
<h2 id="常量引用"><a href="#常量引用" class="headerlink" title="常量引用"></a>常量引用</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> ci = <span class="number">1024</span>; </span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> &amp;r1 = ci; <span class="comment">// ok: both reference and underlying object are const </span></span><br><span class="line">r1 = <span class="number">42</span>; <span class="comment">// error: r1 is a reference to const</span></span><br><span class="line"><span class="keyword">int</span> &amp;r2 = ci; <span class="comment">// error: non const reference to a const object</span></span><br></pre></td></tr></table></figure>

<ul>
<li>常量引用不可修改值</li>
<li>非常量引用不可指向常量对象</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> i = <span class="number">42</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> &amp;r1 = i; <span class="comment">// we can bind a const int&amp; to a plain int object const int &amp;r2 = 42; // ok: r1 is a reference to const</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> &amp;r3 = r1 * <span class="number">2</span>; <span class="comment">// ok: r3 is a reference to const</span></span><br><span class="line"><span class="keyword">int</span> &amp;r4 = r * <span class="number">2</span>; <span class="comment">// error: r4 is a plain, non const reference</span></span><br></pre></td></tr></table></figure>

<p>常量引用可以指向 <em>非常量对象</em>、<em>字面量</em>、<em>通用表达式</em></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">double</span> dval = <span class="number">3.14</span>; </span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> &amp;ri = dval;</span><br></pre></td></tr></table></figure>

<ul>
<li>常量引用会自动强制类型转化</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> temp = dval; <span class="comment">// create a temporary const int from the double </span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> &amp;ri = temp; <span class="comment">// bind ri to that temporary</span></span><br></pre></td></tr></table></figure>

<h2 id="常量指针（pointer-to-const）"><a href="#常量指针（pointer-to-const）" class="headerlink" title="常量指针（pointer to const）"></a>常量指针（pointer to const）</h2><blockquote>
<p>指向常量的指针，指针地址可以修改，但地址存放的值不可以修改</p>
</blockquote>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> pi = <span class="number">3.14</span>; <span class="comment">// pi is const; its value may not be changed</span></span><br><span class="line"><span class="keyword">double</span> *ptr = &amp;pi; <span class="comment">// error: ptr is a plain pointer</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> *cptr = &amp;pi; <span class="comment">// ok: cptr may point to a double that is const </span></span><br><span class="line">*cptr = <span class="number">42</span>; <span class="comment">// error: cannot assign to *cptr</span></span><br></pre></td></tr></table></figure>

<ul>
<li>指向常量的指针地址存放的值不可修改</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">double</span> dval = <span class="number">3.14</span>; <span class="comment">// dval is a double; its value can be changed</span></span><br><span class="line">cptr = &amp;dval; <span class="comment">// ok: but can&#x27;t change dval through cptr</span></span><br></pre></td></tr></table></figure>

<ul>
<li>指向常量的指针可以指向非常量对象</li>
</ul>
<h2 id="指针常量（const-Pointers）"><a href="#指针常量（const-Pointers）" class="headerlink" title="指针常量（const Pointers）"></a>指针常量（const Pointers）</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> errNumb = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> *<span class="keyword">const</span> curErr = &amp;errNumb; <span class="comment">// curErr will always point to errNumb const </span></span><br><span class="line"><span class="keyword">double</span> pi = <span class="number">3.14159</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> *<span class="keyword">const</span> pip = &amp;pi; <span class="comment">// pip is a const pointer to a const object</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>从右往左看：<code>curErr</code>被<code>const</code>修饰，不可修改</p>
</blockquote>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">*pip = <span class="number">2.72</span>; <span class="comment">// error: pip is a pointer to const</span></span><br><span class="line"><span class="comment">// if the object to which curErr points (i.e., errNumb) is nonzero </span></span><br><span class="line"><span class="keyword">if</span> (*curErr) &#123;</span><br><span class="line">*curErr = <span class="number">0</span>; <span class="comment">// ok: reset the value of the object to which curErr is bound &#125;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>Exercises Section 2.4.2<br> Exercise 2.27:</strong> Which of the following initializations are legal? Explain why.</p>
<p> <strong>(a)</strong> int i = -1, &amp;r = 0;<br> <strong>(b)</strong> int <em>const p2 = &i2;<br> <strong>(c)</strong> const int i = -1, &amp;r = 0;<br> <strong>(d)</strong> const int *const p3 = &i2;<br> *</em>(e)** const int *p1 = &i2;<br> <strong>(f)</strong> const int &amp;const r2;<br> <strong>(g)</strong> const int i2 = i, &amp;r = i;</p>
<p>(a)❌ 引用必须指向一个对象</p>
<p>(f)  ❌常量必须初始化</p>
</blockquote>
<blockquote>
<p><strong>Exercise 2.28:</strong> Explain the following definitions. Identify any that are illegal. </p>
<p><strong>(a)</strong> int i, *const cp;<br><strong>(b)</strong> int *p1, *const p2;</p>
<p><strong>(c)</strong> const int ic, &amp;r = ic; </p>
<p><strong>(d)</strong> const int *const p3;</p>
<p><strong>(e)</strong> const int *p;</p>
<p>原因：常量初始化没有赋值</p>
</blockquote>
<h2 id="常量表达式"><a href="#常量表达式" class="headerlink" title="常量表达式"></a>常量表达式</h2><blockquote>
<p>常量表达式是指能够在编译时确定值</p>
</blockquote>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> max_files = <span class="number">20</span>; <span class="comment">// max_files is a constant expression</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> limit = max_files + <span class="number">1</span>; <span class="comment">// limit is a constant expression </span></span><br><span class="line"><span class="keyword">int</span> staff_size = <span class="number">27</span>; <span class="comment">// staff_size is not a constant expression</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> sz = get_size(); <span class="comment">// sz is not a constant expression</span></span><br></pre></td></tr></table></figure>

<p>尽管sz是一个常量，但是它的值只有在运行时才能确定，因此sz不是一个常量表达式</p>
<h2 id="constexpr"><a href="#constexpr" class="headerlink" title="constexpr"></a>constexpr</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">constexpr</span> <span class="keyword">int</span> mf = <span class="number">20</span>; <span class="comment">// 20 is a constant expression </span></span><br><span class="line"><span class="keyword">constexpr</span> <span class="keyword">int</span> limit = mf + <span class="number">1</span>; <span class="comment">// mf + 1 is a constant expression </span></span><br><span class="line"><span class="keyword">constexpr</span> <span class="keyword">int</span> sz = size(); <span class="comment">// ok only if size is a constexpr function</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>constexpr避免了出现上述<code>sz</code>的情况</p>
</blockquote>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> *p = <span class="literal">nullptr</span>; <span class="comment">// p is a pointer to a const int </span></span><br><span class="line"><span class="keyword">constexpr</span> <span class="keyword">int</span> *q = <span class="literal">nullptr</span>; <span class="comment">// q is a const pointer to int</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>constexpr是top-level const，即指针本身是常量（low-level const是指针指向常量对象）</p>
</blockquote>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">constexpr</span> <span class="keyword">int</span> *np = <span class="literal">nullptr</span>; <span class="comment">// np is a constant pointer to int that is null</span></span><br><span class="line"><span class="keyword">int</span> j = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="keyword">int</span> i = <span class="number">42</span>; <span class="comment">// type of i is const int</span></span><br><span class="line"><span class="comment">// i and j must be defined outside any function</span></span><br><span class="line"><span class="keyword">constexpr</span> <span class="keyword">const</span> <span class="keyword">int</span> *p = &amp;i; <span class="comment">// p is a constant pointer to the const int i </span></span><br><span class="line"><span class="keyword">constexpr</span> <span class="keyword">int</span> *p1 = &amp;j; <span class="comment">// p1 is a constant pointer to the int j</span></span><br></pre></td></tr></table></figure>




































      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/06/01/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="林辰">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Leoolin">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/06/01/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" class="post-title-link" itemprop="url">计算机组成原理学习笔记</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-06-01 14:56:34" itemprop="dateCreated datePublished" datetime="2021-06-01T14:56:34+08:00">2021-06-01</time>
            </span>

          
            <span id="/2021/06/01/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" class="post-meta-item leancloud_visitors" data-flag-title="计算机组成原理学习笔记" title="Views">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">Views: </span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/2021/06/01/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2021/06/01/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/06/01/%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="林辰">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Leoolin">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/06/01/%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" class="post-title-link" itemprop="url">汇编语言学习笔记</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-06-01 14:56:22" itemprop="dateCreated datePublished" datetime="2021-06-01T14:56:22+08:00">2021-06-01</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2021-06-02 10:05:21" itemprop="dateModified" datetime="2021-06-02T10:05:21+08:00">2021-06-02</time>
              </span>

          
            <span id="/2021/06/01/%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" class="post-meta-item leancloud_visitors" data-flag-title="汇编语言学习笔记" title="Views">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">Views: </span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/2021/06/01/%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2021/06/01/%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="2-4-物理地址"><a href="#2-4-物理地址" class="headerlink" title="2.4 物理地址"></a>2.4 物理地址</h2><p>CPU访问内存单元时要给出内存单元的地址。我们将这个唯一的地址称为物理地址。</p>
<h2 id="2-5-16位结构的CPU"><a href="#2-5-16位结构的CPU" class="headerlink" title="2.5 16位结构的CPU"></a>2.5 16位结构的CPU</h2><p>16位结构描述了一个CPU具有以下几个方面特征：</p>
<ul>
<li>运算器一次最多可以处理16位的数据</li>
<li>寄存器的最大宽度为16位</li>
<li>寄存器和运算器之间的通路是16位的</li>
</ul>
<h2 id="2-6-8086CPU给出物理地址的方法"><a href="#2-6-8086CPU给出物理地址的方法" class="headerlink" title="2.6 8086CPU给出物理地址的方法"></a>2.6 8086CPU给出物理地址的方法</h2><p>8086有20位地址总线，可传送20位地址，寻址能力为1M</p>
<p>8086内部为16位结构，只能传送16位的地址，寻址能力却只有64k。</p>
<blockquote>
<p>8086CPU采用一种在内部用两个16位地址合成的方法来形成一个20位的物理空间</p>
</blockquote>
<ol>
<li>cpu中的相关部件提供两个16位的地址，一个称为断地址，一个称为偏移地址；</li>
<li>段地址和偏移地址通过内部总线送入一个称为 <strong>地址加法器</strong> 的部件</li>
<li>地址加法器将两个16位地址合并成一个20位的地址</li>
</ol>
<p><img src="/2021/06/01/%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/2.6_1.png" alt="截屏2021-06-02 上午12.02.00"></p>
<h3 id="地址加法器的工作原理"><a href="#地址加法器的工作原理" class="headerlink" title="地址加法器的工作原理"></a>地址加法器的工作原理</h3><p><img src="/2021/06/01/%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/2.6_2.png" alt="截屏2021-06-02 上午12.06.06"></p>
<blockquote>
<p>段地址 * 16，即数据左移4位</p>
</blockquote>
<ul>
<li>一个数据的十六进制形式左移1位，相当于乘以16；</li>
<li>一个数据的十进制形式左移1位，相当于乘以10；</li>
<li>一个数据的X进制形式左移1位，相当于乘以X；</li>
</ul>
<h2 id="2-7-段地址-✖️16-偏移地址-物理地址的本质含义"><a href="#2-7-段地址-✖️16-偏移地址-物理地址的本质含义" class="headerlink" title="2.7 段地址 ✖️16 + 偏移地址 = 物理地址的本质含义"></a>2.7 段地址 ✖️16 + 偏移地址 = 物理地址的本质含义</h2><ul>
<li><p>第一个比喻：</p>
<p><img src="/2021/06/01/%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/2.6_3.png" alt="截屏2021-06-02 上午12.09.59"></p>
<ul>
<li>从学校走2826m到图书馆。这2826可以认为是图书馆的物理地址。</li>
<li>可以分解为从学校走2000m到体育馆，从体育馆再走826m到图书馆<ul>
<li>第一个距离2000m是相当于起点的基础地址</li>
<li>第二个距离826m是相对于基础地址的偏移地址</li>
</ul>
</li>
</ul>
</li>
<li><p>第二个比喻：</p>
<p>用纸条通讯，询问图书馆的地址（目前只有两张可以容纳3位数据的纸条）</p>
<ul>
<li><p>第一张：200</p>
</li>
<li><p>第二张：826</p>
<p>规则：第一张 ✖️10 + 第二张，即可得到地址。</p>
</li>
</ul>
</li>
</ul>
<h2 id="2-8-段的概念"><a href="#2-8-段的概念" class="headerlink" title="2.8 段的概念"></a>2.8 段的概念</h2><p>错误认识：</p>
<p>内存被划分成了一个一个的段，每一个段有一个段地址</p>
<p>其实：</p>
<p>内存并没有分段，段的划分来自于CPU，由于8086CPU用“段地址 ✖️ 16 + 偏移地址 = 物理地址”的方式给出内存单元的物理地址，使得我们可以用分段的方式来管理内存。</p>
<ul>
<li>段地址 ✖️ 16必然是16的倍数，所以一个段的起始地址也一定是16的倍数；</li>
<li>偏移地址为16，16位的地址的寻址能力为64k，所以一个段的长度最大为64k。</li>
</ul>
<blockquote>
<p>如果给定一个段地址，仅通过变化偏移地址来进行寻址，最多可以定位多少内存单元？</p>
<p>结论：偏移地址16位，变化范围为0~FFFFH，仅用偏移地址来寻址最多可寻64k个内存单元。</p>
<p>比如：给定段地址1000H，用偏移地址寻址，CPU的寻址范围为：10000H ~ 1FFFFH。</p>
</blockquote>
<p>数据在21F60H内存中。对于8086PC机的两种描述：</p>
<ol>
<li>数据存在内存2000：1F60单元中；</li>
<li>数据存在内存的2000段中的1F60H单元中。</li>
</ol>
<blockquote>
<p>注：段是可以人为定义的，可根据需要，将地址连续、起始地址为16的倍数的一组内存单元定义为一个段。</p>
</blockquote>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/06/01/C-Primer%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="林辰">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Leoolin">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/06/01/C-Primer%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" class="post-title-link" itemprop="url">C++ Primer学习笔记</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2021-06-01 14:48:46 / Modified: 18:18:12" itemprop="dateCreated datePublished" datetime="2021-06-01T14:48:46+08:00">2021-06-01</time>
            </span>

          
            <span id="/2021/06/01/C-Primer%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" class="post-meta-item leancloud_visitors" data-flag-title="C++ Primer学习笔记" title="Views">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">Views: </span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/2021/06/01/C-Primer%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2021/06/01/C-Primer%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="标准输入输出"><a href="#标准输入输出" class="headerlink" title="标准输入输出"></a>标准输入输出</h1><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Enter two numbers:&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">int</span> v1 = <span class="number">0</span>, v2 = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; v1 &gt;&gt; v2;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;The sum of &quot;</span> &lt;&lt; v1 &lt;&lt; <span class="string">&quot; and &quot;</span> &lt;&lt; v2 &lt;&lt; <span class="string">&quot; is &quot;</span> &lt;&lt; v1 + v2 &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>cin（see-in）：标准输入</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 输入v1的值</span></span><br><span class="line"><span class="keyword">int</span> v1 = <span class="number">0</span>;</span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; v1;</span><br></pre></td></tr></table></figure>
</li>
<li><p>cout(see-out)：标准输出</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 输出字符串&quot;Enter two numbers:&quot;</span></span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Enter two numbers:&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br></pre></td></tr></table></figure>

<h1 id="命名空间（namespace）"><a href="#命名空间（namespace）" class="headerlink" title="命名空间（namespace）"></a>命名空间（namespace）</h1></li>
</ul>
<p>命名空间的出现是为了避免如下的问题：</p>
<p>我们声明了同名函数<code>dance</code>，那么如何调用指定的某个函数呢？</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> Somebody &#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">dance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span>&lt;&lt;<span class="string">&quot;Somebody dances&quot;</span>&lt;&lt;<span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span>&lt;&lt;<span class="string">&quot;I dance&quot;</span>&lt;&lt;<span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>使用命名空间，指定调用的函数：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    dance(); <span class="comment">// 输出：I dance</span></span><br><span class="line">    Somebody::dance(); <span class="comment">// 输出: Somebody dances</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="引用（References）"><a href="#引用（References）" class="headerlink" title="引用（References）"></a>引用（References）</h1><blockquote>
<p>引用就是一个对象的别名</p>
<p>A reference is not an object. Instead, a reference is just another name for an already existing object.</p>
</blockquote>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ival = <span class="number">1024</span>;</span><br><span class="line">    <span class="keyword">int</span> &amp;refVal = ival;</span><br><span class="line">    refVal = <span class="number">512</span>;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; ival &lt;&lt; <span class="built_in">endl</span>; <span class="comment">// 512</span></span><br><span class="line">    <span class="keyword">int</span> &amp;refVal2; <span class="comment">// error: references must be initialized.</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>引用必须初始化</li>
<li>一旦初始化，不可以再将引用指向其他对象</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> &amp;refVal4 = <span class="number">10</span>; <span class="comment">// error: initializer must be an object </span></span><br><span class="line"><span class="keyword">double</span> dval = <span class="number">3.14</span>;</span><br><span class="line"><span class="keyword">int</span> &amp;refVal5 = dval; <span class="comment">// error: initializer must be an int object</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>Exercises Section 2.3.1</strong></p>
<p><strong>Exercise 2.15:</strong> Which of the following definitions, if any, are invalid? Why?</p>
<p><strong>(a)</strong> int ival = 1.01;</p>
<p><strong>(b)</strong> int &amp;rval1 = 1.01;</p>
<p><strong>(c)</strong> int &amp;rval2 = ival;</p>
<p><strong>(d)</strong> int &rval3;</p>
</blockquote>
<p>(a) ✅（b）❌  初始化赋值必须是int对象</p>
<p> (c)  ✅ （d）❌ 引用必须被初始化</p>
<h1 id="指针（Pointers）"><a href="#指针（Pointers）" class="headerlink" title="指针（Pointers）"></a>指针（Pointers）</h1><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> *ip1, *ip2; <span class="comment">// both ip1 and ip2 are pointers to int </span></span><br><span class="line"><span class="keyword">double</span> dp, *dp2; <span class="comment">// dp2 is a pointer to double; dp is a double</span></span><br></pre></td></tr></table></figure>

<ul>
<li>与引用不同，指针本身就是一个对象</li>
<li>在指针的生命周期中，可以指向不同的对象</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> ival = <span class="number">42</span>;</span><br><span class="line"><span class="keyword">int</span> *p = &amp;ival; <span class="comment">// p holds the address of ival; p is a pointer to ival</span></span><br></pre></td></tr></table></figure>

<ul>
<li>指针存放的值是另一个对象的地址</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">double</span> dval;</span><br><span class="line"><span class="keyword">double</span> *pd = &amp;dval; <span class="comment">// ok: initializer is the address of a double</span></span><br><span class="line"><span class="keyword">double</span> *pd2 = pd; <span class="comment">// ok: initializer is a pointer to double</span></span><br><span class="line"><span class="keyword">int</span> *pi = pd; <span class="comment">// error: types of pi and pd differ</span></span><br><span class="line">pi = &amp;dval; <span class="comment">// error: assigning the address of a double to a pointer to int</span></span><br></pre></td></tr></table></figure>

<ul>
<li>指针类型必须和其指向的地址中存放的对象的类型相同</li>
</ul>
<blockquote>
<p>注：&amp; 和 * 有多种含义</p>
<p>&amp;、*可以当做声明使用，比如：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> i = <span class="number">42</span>;</span><br><span class="line"><span class="keyword">int</span>&amp;r=i; <span class="comment">//&amp; *followsatypeandispartofadeclaration; r is a *reference*</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> *p; <span class="comment">// * *follows a type and is part of a declaration; p is a *pointer*</span></span><br></pre></td></tr></table></figure>

<p>&amp;也可以作取地址符使用：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">p = &amp;i； <span class="comment">// &amp; is used in an expression as the address-of operator.</span></span><br></pre></td></tr></table></figure>

<p>*可以作取值符号使用：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">*p = i; <span class="comment">// * is used in an expression as the dereference operator</span></span><br><span class="line"><span class="keyword">int</span> &amp;r2 = *p; <span class="comment">// &amp; is part of the declaration; * is the dereference operator</span></span><br></pre></td></tr></table></figure>
</blockquote>
<ol>
<li><p>使用指针访问一个对象</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> ival = <span class="number">42</span>;</span><br><span class="line"><span class="keyword">int</span> *p = &amp;ival; <span class="comment">// p holds the address of ival; p is a pointer to ival </span></span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; *p; <span class="comment">// * yields the object to which p points; prints 42</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>使用指针指向空指针（Null Pointers）</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> *p1 = <span class="literal">nullptr</span>; <span class="comment">// equivalent to int *p1 = 0;</span></span><br><span class="line"><span class="keyword">int</span> *p2 = <span class="number">0</span>; <span class="comment">// directly initializes p2 from the literal constant 0 </span></span><br><span class="line"><span class="comment">// must #include cstdlib</span></span><br><span class="line"><span class="keyword">int</span> *p3 = <span class="literal">NULL</span>; <span class="comment">// equivalent to int *p3 = 0;</span></span><br></pre></td></tr></table></figure>

</li>
</ol>
<h2 id="void指针（void-Pointers）"><a href="#void指针（void-Pointers）" class="headerlink" title="void指针（void* Pointers）"></a>void指针（void* Pointers）</h2><p>void指针能够指向任意类型的对象</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">double</span> obj = <span class="number">3.14</span>, *pd = &amp;obj;</span><br><span class="line"><span class="comment">// ok: void* can hold the address value of any data pointer type</span></span><br><span class="line"><span class="keyword">void</span> *pv = &amp;obj; <span class="comment">// obj can be an object of any type</span></span><br><span class="line">pv = pd; <span class="comment">// pv can hold a pointer to any type</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>Exercise 2.20:</strong> What does the following program do?</p>
<p>int i = 42;<br>int *p1 = &i; </p>
<p>*p1 = *p1 * *p1;</p>
</blockquote>
<p>*p1 = 42 * 42</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/09/12/%E8%81%8A%E4%B8%80%E8%81%8A%E8%84%9A%E6%9C%AC%E8%AF%AD%E8%A8%80%EF%BC%9AAppleScript/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="林辰">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Leoolin">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/09/12/%E8%81%8A%E4%B8%80%E8%81%8A%E8%84%9A%E6%9C%AC%E8%AF%AD%E8%A8%80%EF%BC%9AAppleScript/" class="post-title-link" itemprop="url">聊一聊脚本语言：AppleScript</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-09-12 21:59:16" itemprop="dateCreated datePublished" datetime="2020-09-12T21:59:16+08:00">2020-09-12</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-09-13 00:10:33" itemprop="dateModified" datetime="2020-09-13T00:10:33+08:00">2020-09-13</time>
              </span>

          
            <span id="/2020/09/12/%E8%81%8A%E4%B8%80%E8%81%8A%E8%84%9A%E6%9C%AC%E8%AF%AD%E8%A8%80%EF%BC%9AAppleScript/" class="post-meta-item leancloud_visitors" data-flag-title="聊一聊脚本语言：AppleScript" title="Views">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">Views: </span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/2020/09/12/%E8%81%8A%E4%B8%80%E8%81%8A%E8%84%9A%E6%9C%AC%E8%AF%AD%E8%A8%80%EF%BC%9AAppleScript/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2020/09/12/%E8%81%8A%E4%B8%80%E8%81%8A%E8%84%9A%E6%9C%AC%E8%AF%AD%E8%A8%80%EF%BC%9AAppleScript/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><blockquote>
<p>笔者学习AppleScript的起因，是因为本人键盘修饰键的使用习惯和其他同事不同，笔者习惯于将「大小写修饰键」和「Ctrl键」互调位置，以至于习惯默认修饰键配置的同事在我的电脑上进行调试，总是忍不住感叹一声：<br>“这TM是人用的吗？”<br>相信了解iOS开发的小伙伴们都知道，Ctrl + Command + 上下，可以切换.h和.m文件，但是在笔者的键盘上，执行这一操作时，不但没有任何的效果，还会把键盘设置成了大写模式，在一次又一次，同事怒吼的咆哮后，笔者痛定思通，决心要解决这个问题，在如何不改变自己键盘使用习惯的前提下，让来调试代码的同事们也感到如使用自己键盘般的流畅和丝滑呢？</p>
<p>于是，就有就有了这篇<code>聊一聊脚本语言：AppleScript</code></p>
</blockquote>
<h2 id="AppleScript的实践应用"><a href="#AppleScript的实践应用" class="headerlink" title="AppleScript的实践应用"></a>AppleScript的实践应用</h2><h3 id="实践：还原修饰键默认设置"><a href="#实践：还原修饰键默认设置" class="headerlink" title="实践：还原修饰键默认设置"></a>实践：还原修饰键默认设置</h3><blockquote>
<p>本文下面比较详细地介绍了AppleScript基础知识，在学习它们之前，只需要简单了解AppleScript中常用的几个概念，就可以实现GUI Scripting的神奇功效，我们先来看看AppleScript中的常用概念</p>
</blockquote>
<h2 id="AppleScript的常用概念"><a href="#AppleScript的常用概念" class="headerlink" title="AppleScript的常用概念"></a>AppleScript的常用概念</h2><p>这是一个神奇的传送门☞<a href="applescript://">脚本编辑器</a>（本文所有代码均可直接在IDE中执行）</p>
<p>我们先了解下我们的IDE工具，打开脚本编辑器</p>
<p><img src="/2020/09/12/%E8%81%8A%E4%B8%80%E8%81%8A%E8%84%9A%E6%9C%AC%E8%AF%AD%E8%A8%80%EF%BC%9AAppleScript/1.png" alt="1.png"></p>
<p>点击图片中的按钮，可以看到上面除了「结果」选项外，还多出了「信息」、「事件」和「回复」三个选项，在这里面可以看到更为详细的打印信息！</p>
<p><img src="/2020/09/12/%E8%81%8A%E4%B8%80%E8%81%8A%E8%84%9A%E6%9C%AC%E8%AF%AD%E8%A8%80%EF%BC%9AAppleScript/2.png" alt="2.png"></p>
<p>AppleScript的必须掌握的命令：</p>
<ul>
<li>tell someone do something</li>
</ul>
<p>AppleScript的语法十分接近自然语言，想要操作一个对象执行某些操作，只需要使用”tell命令 +对象类型 + 对象名”，在之后执行<code>end tell</code>，结束当前的回话</p>
<p>激活终端</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">tell application &quot;Terminal&quot;</span><br><span class="line">	activate -- 告诉 终端，执行激活命令</span><br><span class="line">end tell</span><br></pre></td></tr></table></figure>

<p>关闭终端</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">tell application &quot;Terminal&quot;</span><br><span class="line">	quit -- 告诉 终端，执行退出命令</span><br><span class="line">end tell</span><br></pre></td></tr></table></figure>

<p>System Events是系统应用，我们有时寄期望于在系统应用中找到某个正在执行的进程（Process）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">tell application &quot;System Events&quot;</span><br><span class="line">	tell process &quot;Terminal&quot;</span><br><span class="line">	end tell</span><br><span class="line">end tell</span><br></pre></td></tr></table></figure>

<p>在执行这段代码后，你会发现，其实什么都没有执行，不用慌，这是因为你并没有告诉”终端”要做些什么，那么我们通过<code>entire contents </code>命令获取Terminal内的所有UI元素</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">#执行下面代码前，先激活&quot;终端&quot;</span><br><span class="line"></span><br><span class="line">tell application &quot;System Events&quot;</span><br><span class="line">	tell process &quot;Terminal&quot;</span><br><span class="line">		entire contents --获取区域内所有的UI元素</span><br><span class="line">	end tell</span><br><span class="line">end tell</span><br></pre></td></tr></table></figure>

<p>执行后，会得到”终端”内的所有UI元素的完整描述</p>
<p><img src="/2020/09/12/%E8%81%8A%E4%B8%80%E8%81%8A%E8%84%9A%E6%9C%AC%E8%AF%AD%E8%A8%80%EF%BC%9AAppleScript/3.png" alt="3.png"></p>
<p>选择日志中的一条进行分析</p>
<blockquote>
<p><em>button</em> 1 <strong>of</strong> <em>window</em> “终端 — -zsh — 80×24” <strong>of</strong> <em>application process</em> “Terminal” <strong>of</strong> <em>application</em> “System Events”</p>
</blockquote>
<p>其实这其中的从属关系已经十分明确了，翻译过来就是</p>
<blockquote>
<p>应用<code>System Events</code>的应用进程<code>Terminal</code>的<code>窗口</code>的<code>按钮1</code></p>
</blockquote>
<ul>
<li>模拟点击</li>
</ul>
<p><em>button 1</em>的描述，我们已经很清楚了，那<em>button 1</em>到底对应”终端”中的哪个按钮呢？其实单从名字上看，很难看出<em>button 1</em>对应的是哪个按钮，那么我们用一个很简单的方法，确定它的位置，让button 1执行点击操作，通过它的点击效果反推它的位置！</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">#执行下面代码前，先激活&quot;终端&quot;</span><br><span class="line"></span><br><span class="line">tell application &quot;System Events&quot;</span><br><span class="line">	</span><br><span class="line">	tell process &quot;Terminal&quot;</span><br><span class="line">		(*</span><br><span class="line">			注意：由于环境的差异性，直接复制这段代码到你的脚本编辑器，可能得不到想要的效果</span><br><span class="line">			这里一定要输入你上面entire contents后，打印的&quot;button 1&quot;的完整结果</span><br><span class="line">			*)</span><br><span class="line">		click button 1 of window &quot;终端 — -zsh — 80×24&quot; of application process &quot;Terminal&quot; of application &quot;System Events&quot; </span><br><span class="line">	end tell</span><br><span class="line">	</span><br><span class="line">end tell</span><br></pre></td></tr></table></figure>

<p>执行上述操作后，发现”终端”被关闭了，原来<em>button 1</em>对应的就是”终端”左上角的关闭按钮</p>
<blockquote>
<p>请注意：并不是所有的<em>button 1</em>对应的都是应用的关闭按钮，还要具体情况具体分析</p>
</blockquote>
<ul>
<li>模拟输入</li>
</ul>
<p>我们打开了终端，想看当前目录下存有哪些文件，该如何操作呢？</p>
<p>想一下这个问题，我们都知道在终端中查看目录下文件的命令是<code>ls</code>，那么就可以将这个问题拆分为键入’ls’和点击回车两个步骤</p>
<p>在AppleScript中，输入字符串的命令是<code>keystroke</code>，你也可以用<code>key code</code>实现单键点击</p>
<p>我们完善一下代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">tell application &quot;Terminal&quot;</span><br><span class="line">	activate</span><br><span class="line">end tell</span><br><span class="line"></span><br><span class="line">tell application &quot;System Events&quot;</span><br><span class="line">	</span><br><span class="line">	tell process &quot;Terminal&quot;</span><br><span class="line">		keystroke &quot;ls&quot;</span><br><span class="line">		delay 1 -- 延时一秒后执行</span><br><span class="line">		key code 36 -- 回车的键位码为36</span><br><span class="line">	end tell</span><br><span class="line">	</span><br><span class="line">end tell</span><br></pre></td></tr></table></figure>

<p>完整的键位码传送门☞<a target="_blank" rel="noopener" href="https://eastmanreference.com/complete-list-of-applescript-key-codes">键位码</a></p>
<p>我们有时需要通过组合按键的方式执行某一操作，通过在键入命令后添加<code>using &#123;按键A down, 按键B down&#125;</code>的方式，如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#强制关闭应用快捷键</span><br><span class="line">key code 53 using &#123;command down, option down&#125; -- Esc的键位码为53</span><br></pre></td></tr></table></figure>

<ul>
<li>执行shell命令</li>
</ul>
<p>在终端中通过执行shell命令的方式可以达到和模拟键入的同样的效果</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">tell application &quot;Terminal&quot;</span><br><span class="line">	activate</span><br><span class="line">	do script &quot;ls&quot; </span><br><span class="line">end tell</span><br></pre></td></tr></table></figure>

<p>当然也可打开某路径下的文件，这里我们尝试打开”系统偏好设置”中的”键盘偏好设置”</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">tell application &quot;Terminal&quot;</span><br><span class="line">	activate</span><br><span class="line">	#打开键盘偏好设置</span><br><span class="line">	do script &quot;open .  &#39;&#x2F;System&#x2F;Library&#x2F;PreferencePanes&#x2F;Keyboard.prefPane&#39;&quot;</span><br><span class="line">end tell</span><br></pre></td></tr></table></figure>

<p>我们简单回顾一下，现在我们已经了解了：</p>
<ul>
<li><p>如何激活应用，并在当前的系统进程中找到它</p>
</li>
<li><p>如何获取某一区域内的全部UI控件，并尝试点击其中的某一个单独控件</p>
</li>
<li><p>如何实现模拟字符串输入、单键输入和组合输入</p>
</li>
<li><p>如何关闭应用</p>
</li>
</ul>
<p>此外，我们再多了解两个帮助我们编写代码的两个小知识点：</p>
<p>1.注释</p>
<p>AppleScript中的注释分为单行注释和多行注释</p>
<p>单行注释：<code>#</code>、<code>--</code></p>
<p>多行注释 <code>(* 中间的部分都是注释 *)</code></p>
<p>（上文中三种注释均有用到）</p>
<p>2.输出日志</p>
<p><code>log</code>命令，可以通过打印辅助信息，来帮助我们编写代码</p>
<p>至此，你已经掌握了实现恢复系统默认修饰键的全部知识，小伙伴们完全可以自己尝试写下代码</p>
<hr>
<p>核心代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">#激活</span><br><span class="line">tell application &quot;Terminal&quot;</span><br><span class="line">	activate</span><br><span class="line">	#打开键盘偏好设置</span><br><span class="line">	do script &quot;open .  &#39;&#x2F;System&#x2F;Library&#x2F;PreferencePanes&#x2F;Keyboard.prefPane&#39;&quot;</span><br><span class="line">end tell</span><br><span class="line"></span><br><span class="line">tell application &quot;System Events&quot;</span><br><span class="line">	</span><br><span class="line">	tell process &quot;系统偏好设置&quot;</span><br><span class="line">		#点击修饰键		</span><br><span class="line">		click button &quot;修饰键…&quot; of tab group 1 of window &quot;键盘&quot; -- of application process &quot;System Preferences&quot; of application &quot;System Events&quot;</span><br><span class="line">		</span><br><span class="line">		#更改为默认状态</span><br><span class="line">		click button &quot;修饰键…&quot; of tab group 1 of window &quot;键盘&quot; -- of application process &quot;System Preferences&quot; of application &quot;System Events&quot;</span><br><span class="line">		click button &quot;恢复成默认&quot; of sheet 1 of window &quot;键盘&quot; -- of application process &quot;System Preferences&quot; of application &quot;System Events&quot;</span><br><span class="line">			</span><br><span class="line">		click button &quot;好&quot; of sheet 1 of window &quot;键盘&quot; -- of application process &quot;System Preferences&quot; of ®application &quot;System Events&quot;</span><br><span class="line">		</span><br><span class="line">	end tell</span><br><span class="line">	</span><br><span class="line">end tell</span><br></pre></td></tr></table></figure>

<p>编写完成后，选择导出：</p>
<p><img src="/2020/09/12/%E8%81%8A%E4%B8%80%E8%81%8A%E8%84%9A%E6%9C%AC%E8%AF%AD%E8%A8%80%EF%BC%9AAppleScript/5.png"></p>
<p>笔者在这里<code>文件格式</code>选择的是<code>应用程序</code>，并设置了对应的配合快捷键，实现快捷调用~</p>
<p><img src="/2020/09/12/%E8%81%8A%E4%B8%80%E8%81%8A%E8%84%9A%E6%9C%AC%E8%AF%AD%E8%A8%80%EF%BC%9AAppleScript/6.png"></p>
<p><font color="#D61717">完整代码传送门，欢迎Star☞<a target="_blank" rel="noopener" href="https://github.com/GCSNNB/ASShortcutKey-">ASShortcutkey</a></font></p>
<h2 id="AppleScript基础知识"><a href="#AppleScript基础知识" class="headerlink" title="AppleScript基础知识"></a>AppleScript基础知识</h2><h3 id="1-基本模块"><a href="#1-基本模块" class="headerlink" title="1.基本模块"></a>1.基本模块</h3><h4 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#符号&#39;¬&#39;（option+&#39;L&#39;） 用来将语句延续到第二行</span><br><span class="line">display dialog &quot;This is just a test.&quot; buttons &#123;&quot;Great&quot;, &quot;OK&quot;&#125; ¬</span><br><span class="line">default button &quot;OK&quot; giving up after 3 --result：调出弹窗,默认键是OK,3秒后消失</span><br></pre></td></tr></table></figure>

<h4 id="变量和属性"><a href="#变量和属性" class="headerlink" title="变量和属性"></a>变量和属性</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">#变量赋值</span><br><span class="line">set myName to &quot;John&quot;</span><br><span class="line">copy 22 to myAge</span><br><span class="line"></span><br><span class="line">#局部变量</span><br><span class="line">local windowCount</span><br><span class="line">local agentName，agentNumber，agentHireDate</span><br><span class="line"></span><br><span class="line">#全局变量</span><br><span class="line">global gAgentCount</span><br><span class="line">global gStatementDate，gNextAgentNumber</span><br><span class="line"></span><br><span class="line">#属性</span><br><span class="line">property defaultClientName : &quot;Mary Smith&quot;</span><br><span class="line"></span><br><span class="line">#字符串中引用变量</span><br><span class="line">set aPerson to &quot;GCS&quot;</span><br><span class="line">display dialog &quot;Hello &quot; &amp; aPerson &amp; &quot;!&quot;</span><br></pre></td></tr></table></figure>

<h4 id="类型转换"><a href="#类型转换" class="headerlink" title="类型转换"></a>类型转换</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">set myText to 2 as text</span><br></pre></td></tr></table></figure>

<h4 id="运算符"><a href="#运算符" class="headerlink" title="运算符"></a>运算符</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">3 * 7 - &quot;1&quot; --result 20</span><br></pre></td></tr></table></figure>

<h4 id="List-数组"><a href="#List-数组" class="headerlink" title="List(数组)"></a>List(数组)</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#初始化数组</span><br><span class="line">set myList to &#123;1, &quot;what&quot;, 3&#125; --result: &#123;1, &quot;what&quot;, 3&#125;</span><br><span class="line">set beginning of myList to 0 --首位设置为0</span><br><span class="line">set end of myList to &quot;four&quot; --末位设置为&quot;four&quot;</span><br><span class="line">set item 2 of myList to 4 --第二位设置为4</span><br><span class="line">myList --result: &#123;0, 4, &quot;what&quot;, 3, &quot;four&quot;&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Record（键值对）"><a href="#Record（键值对）" class="headerlink" title="Record（键值对）"></a>Record（键值对）</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#存值</span><br><span class="line">set myFullName to &#123;firstName:&quot;John&quot;, lastName:&quot;Chapman&quot;&#125;</span><br><span class="line">#取值</span><br><span class="line">set myLastName to lastName of myFullName --result &quot;Chapman&quot;</span><br></pre></td></tr></table></figure>

<h3 id="2-控制语句"><a href="#2-控制语句" class="headerlink" title="2.控制语句"></a>2.控制语句</h3><h4 id="considering-ignoring"><a href="#considering-ignoring" class="headerlink" title="considering/ignoring"></a>considering/ignoring</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&quot;Hello Bob&quot; &#x3D; &quot;HelloBob&quot; --result: false</span><br><span class="line">ignoring white space --忽略空格</span><br><span class="line">    &quot;Hello Bob&quot; &#x3D; &quot;HelloBob&quot; --result: true</span><br><span class="line">end ignoring</span><br><span class="line"></span><br><span class="line">&quot;BOB&quot; &#x3D; &quot;bob&quot; --result: true</span><br><span class="line">considering case --考虑大小写</span><br><span class="line">    &quot;BOB&quot; &#x3D; &quot;bob&quot; --result: false</span><br><span class="line">end considering</span><br></pre></td></tr></table></figure>

<h4 id="try-error"><a href="#try-error" class="headerlink" title="try-error"></a>try-error</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">try</span><br><span class="line">	word 5 of &quot;one two three&quot;</span><br><span class="line">on error</span><br><span class="line">	error &quot;There are not enough words.&quot;</span><br><span class="line">end try</span><br></pre></td></tr></table></figure>

<h4 id="if"><a href="#if" class="headerlink" title="if"></a>if</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">set currentTemp to 10</span><br><span class="line">if currentTemp &lt; 60 then</span><br><span class="line">    set response to &quot;It&#39;s a little chilly today.&quot;</span><br><span class="line">else if currentTemp &gt; 80 then</span><br><span class="line">    set response to &quot;It&#39;s getting hotter today.&quot;</span><br><span class="line">else</span><br><span class="line">    set response to &quot;It&#39;s a nice day today.&quot;</span><br><span class="line">end if</span><br><span class="line">display dialog response</span><br></pre></td></tr></table></figure>

<h4 id="repeat-exit"><a href="#repeat-exit" class="headerlink" title="repeat-exit"></a>repeat-exit</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">set num to 0</span><br><span class="line">repeat</span><br><span class="line">	-- perform operations</span><br><span class="line">	if num &lt; 5 then</span><br><span class="line">		set num to num + 1</span><br><span class="line">	else</span><br><span class="line">		display dialog num</span><br><span class="line">		exit repeat</span><br><span class="line">	end if</span><br><span class="line">end repeat</span><br></pre></td></tr></table></figure>

<h4 id="repeat-number-times"><a href="#repeat-number-times" class="headerlink" title="repeat (number) times"></a>repeat (number) times</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">set x to 3</span><br><span class="line">set power to 3</span><br><span class="line"></span><br><span class="line">set returnVal to x</span><br><span class="line">repeat power - 1 times</span><br><span class="line">	set returnVal to returnVal * x</span><br><span class="line">end repeat</span><br><span class="line">return returnVal</span><br></pre></td></tr></table></figure>

<h4 id="repeat-while-当型循环"><a href="#repeat-while-当型循环" class="headerlink" title="repeat while(当型循环)"></a>repeat while(当型循环)</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">set userNotDone to true</span><br><span class="line">repeat while userNotDone</span><br><span class="line">	set userNotDone to enterDataRecord()</span><br><span class="line">end repeat</span><br><span class="line"></span><br><span class="line">on enterDataRecord()</span><br><span class="line">	delay 3</span><br><span class="line">	false</span><br><span class="line">end enterDataRecord </span><br></pre></td></tr></table></figure>

<h4 id="数值循环"><a href="#数值循环" class="headerlink" title="数值循环"></a>数值循环</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">set n to 3</span><br><span class="line">set returnVal to 0</span><br><span class="line">repeat with i from 0 to n</span><br><span class="line">	set returnVal to returnVal + I</span><br><span class="line">end repeat</span><br><span class="line">return returnVal</span><br></pre></td></tr></table></figure>

<p>(数组遍历)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">set peopleList to &#123;&quot;Chris&quot;, &quot;David&quot;, &quot;Sal&quot;, &quot;Ben&quot;&#125;</span><br><span class="line"></span><br><span class="line">#方法一</span><br><span class="line">repeat with aPerson in peopleList</span><br><span class="line">    display dialog &quot;Hello &quot; &amp; aPerson &amp; &quot;!&quot;</span><br><span class="line">end repeat</span><br><span class="line"></span><br><span class="line">#方法二</span><br><span class="line">repeat with i from 1 to (number of items in peopleList)</span><br><span class="line">    display dialog &quot;Hello &quot; &amp; item i of peopleList &amp; &quot;!&quot;</span><br><span class="line">end repeat</span><br></pre></td></tr></table></figure>

<h4 id="String-to-List"><a href="#String-to-List" class="headerlink" title="String to List"></a>String to List</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">set wordList to words in &quot;Where is the hammer?&quot;</span><br><span class="line">repeat with currentWord in wordList</span><br><span class="line">	log currentWord</span><br><span class="line">	if (contents of currentWord) is equal to &quot;hammer&quot; then</span><br><span class="line">		display dialog &quot;I found the hammer!&quot;</span><br><span class="line">	end if</span><br><span class="line">end repeat</span><br></pre></td></tr></table></figure>

<h4 id="record遍历"><a href="#record遍历" class="headerlink" title="record遍历"></a>record遍历</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">#在文档中没有找到遍历record的方法，不知道是不是不小心遗漏了</span><br><span class="line">#但是在Stack Overflow中看有如下方法，引入了OC中的Foundation库，实现了record的遍历</span><br><span class="line">use framework &quot;Foundation&quot;</span><br><span class="line">set testRecord to &#123;a:&quot;aaa&quot;, b:&quot;bbb&quot;, c:&quot;ccc&quot;&#125;</span><br><span class="line"></span><br><span class="line">set objCDictionary to current application&#39;s NSDictionary&#39;s dictionaryWithDictionary:testRecord</span><br><span class="line">set allKeys to objCDictionary&#39;s allKeys()</span><br><span class="line"></span><br><span class="line">repeat with theKey in allKeys</span><br><span class="line">	log theKey as text</span><br><span class="line">	log (objCDictionary&#39;s valueForKey:theKey) as text</span><br><span class="line">end repeat</span><br></pre></td></tr></table></figure>

<h3 id="3-函数构造"><a href="#3-函数构造" class="headerlink" title="3.函数构造"></a>3.函数构造</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">on greetClient(nameOfClient)</span><br><span class="line">	display dialog (&quot;Hello &quot; &amp; nameOfClient &amp; &quot;!&quot;)</span><br><span class="line">end greetClient</span><br><span class="line"></span><br><span class="line">greetClient(&quot;GCS_DEVELOPER&quot;)</span><br></pre></td></tr></table></figure>

<h3 id="4-脚本对象"><a href="#4-脚本对象" class="headerlink" title="4.脚本对象"></a>4.脚本对象</h3><ul>
<li>定义/执行脚本</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">script John</span><br><span class="line">	property HowManyTimes : 0</span><br><span class="line">	</span><br><span class="line">	to sayHello to someone</span><br><span class="line">		set HowManyTimes to HowManyTimes + 1</span><br><span class="line">		return &quot;Hello &quot; &amp; someone</span><br><span class="line">	end sayHello</span><br><span class="line">	</span><br><span class="line">end script</span><br><span class="line"></span><br><span class="line">tell John to sayHello to &quot;Herb&quot;</span><br><span class="line">#John&#39;s sayHello to &quot;Jake&quot; --result: &quot;Hello Jake&quot;</span><br><span class="line">#sayHello of John to &quot;Jake&quot; --result: &quot;Hello Jake&quot;</span><br></pre></td></tr></table></figure>

<ul>
<li>初始化脚本</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">on makePoint(x, y)</span><br><span class="line">    script thePoint</span><br><span class="line">        property xCoordinate:x</span><br><span class="line">        property yCoordinate:y</span><br><span class="line">    end script</span><br><span class="line">    return thePoint</span><br><span class="line">end makePoint</span><br><span class="line"> </span><br><span class="line">set myPoint to makePoint(10,20)</span><br><span class="line">get xCoordinate of myPoint  --result: 10</span><br><span class="line">get yCoordinate of myPoint  --result: 20</span><br></pre></td></tr></table></figure>

<ul>
<li>继承</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">script Alex</span><br><span class="line">    on sayHello()</span><br><span class="line">        return &quot;Hello, &quot; &amp; getName()</span><br><span class="line">    end sayHello</span><br><span class="line">    on getName()</span><br><span class="line">        return &quot;Alex&quot;</span><br><span class="line">    end getName</span><br><span class="line">end script</span><br><span class="line"> </span><br><span class="line">script AlexJunior</span><br><span class="line">    property parent : Alex</span><br><span class="line">    on getName()</span><br><span class="line">        return &quot;Alex Jr&quot;</span><br><span class="line">    end getName</span><br><span class="line">end script</span><br><span class="line"> </span><br><span class="line">-- Sample calls to handlers in the script objects:</span><br><span class="line">tell Alex to sayHello() --result: &quot;Hello, Alex&quot;</span><br><span class="line">tell AlexJunior to sayHello() --result: &quot;Hello, Alex Jr.&quot;</span><br><span class="line"> </span><br><span class="line">tell Alex to getName() --result: &quot;Alex&quot;</span><br><span class="line">tell AlexJunior to getName() --result: &quot;Alex Jr&quot;</span><br></pre></td></tr></table></figure>

<h2 id="写在结尾"><a href="#写在结尾" class="headerlink" title="写在结尾"></a>写在结尾</h2><p>本文记录的只是AppleScript中的一小部分内容，笔者在网上暂时还没有找到十分详细的中文文档和介绍，所以想要更加深入的了解和学习AppleScript还是查看官方文档！</p>
<p>一手资料☞<a target="_blank" rel="noopener" href="https://developer.apple.com/library/archive/documentation/AppleScript/Conceptual/AppleScriptLangGuide/introduction/ASLR_intro.html">AppleScript Language Guide</a></p>
<p>参考资料：</p>
<p><a target="_blank" rel="noopener" href="https://sspai.com/post/43758">手把手教你用 AppleScript 模拟鼠标键盘操作，实现 macOS 系统的自动化操作</a></p>
<h3 id><a href="#" class="headerlink" title></a></h3>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/09/10/App-Clip%E7%A6%BB%E8%90%BD%E5%9C%B0%E6%9C%89%E5%A4%9A%E8%BF%9C/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="林辰">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Leoolin">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/09/10/App-Clip%E7%A6%BB%E8%90%BD%E5%9C%B0%E6%9C%89%E5%A4%9A%E8%BF%9C/" class="post-title-link" itemprop="url">App Clip离落地有多远？</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2020-09-10 18:18:36 / Modified: 21:08:07" itemprop="dateCreated datePublished" datetime="2020-09-10T18:18:36+08:00">2020-09-10</time>
            </span>

          
            <span id="/2020/09/10/App-Clip%E7%A6%BB%E8%90%BD%E5%9C%B0%E6%9C%89%E5%A4%9A%E8%BF%9C/" class="post-meta-item leancloud_visitors" data-flag-title="App Clip离落地有多远？" title="Views">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">Views: </span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/2020/09/10/App-Clip%E7%A6%BB%E8%90%BD%E5%9C%B0%E6%9C%89%E5%A4%9A%E8%BF%9C/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2020/09/10/App-Clip%E7%A6%BB%E8%90%BD%E5%9C%B0%E6%9C%89%E5%A4%9A%E8%BF%9C/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="一：前言"><a href="#一：前言" class="headerlink" title="一：前言"></a>一：前言</h2><p>之前也陆陆续续看过一些介绍App Clip的技术文章，发现这些文章几乎千篇一律，差不多都是「苹果技术文档」和「WWDC视频截图」的拼装，以及「WWDC视频讲解」和「网上同类文章」的复述，却很少谈及<em>App Clip</em>真正落地的业务场景和涉及的技术问题。</p>
<p>App Clip发布后，我开始负责App Clip的技术调研工作，也是沾团队的光，约到了一个App Clip lab，感受了一把白天看WWDC，晚上和WWDC讲解人一对一交流的体验，虽然我们团队最后决定先暂停App Clip的开发，但是在调研App Clip的过程中，也确实发现了很多值得思考之处。</p>
<p>先说一个结论：不要因为看了WWDC和一些技术文章，就对App Clip有过分美好的幻想，至少从目前来看，App Clip的坑还很多。</p>
<h2 id="二：业务原因"><a href="#二：业务原因" class="headerlink" title="二：业务原因"></a>二：业务原因</h2><h3 id="2-1-业务场景少"><a href="#2-1-业务场景少" class="headerlink" title="2.1 业务场景少"></a>2.1 业务场景少</h3><ol>
<li><p>线下支付</p>
<p>看过WWDC视频的小伙伴们可能已经察觉到了，视频中介绍的场景90%以上都是线下支付的场景，不知道苹果的本意是不是希望通过App Clip去抢占o2o市场，虽然说的是「不用安装商家App」即可通过App Clip享受便捷服务，快速完成下单。可在中国，用户绝大部分的时候本来就不需要下载商家App，难道小程序不香嘛？况且就算真的有这种需求，目前能够满足的也仅仅是iOS 14系统以上的iOS用户。所以这种线下支付的场景，至少在目前看来，App Clip甚至称不上现有方案的一个<em>有效替代方案</em>。</p>
</li>
<li><p>线上拉新</p>
<p>既然线下支付推进困难重重，那肯定很多人会把目光重新看向线上场景。因为App Clip具备「及时可用」的特点，让用户不用下载完整的App即可享受到App的部分功能，那不妨就把App Clip做为一个拉新的入口，把Clip当做「试用装」吸引用户，等用户习惯了，再引导用户下载App。理想虽然很美好，可现实中怎么把「试用装」交到用户手中呢？我们知道，App Clip的调用场景目前主要就5种，二维码、Safari Smart Banner、NFC、Map和Message。</p>
<p>其中NFC需要物理介质，Map需要实体店，它们对于纯线上的App来说很难找到应用的场景。</p>
<p>Message更不用说了，首先国人对Message聊天的需求本来就不大，也总不能群发带Clip的短信给用户吧？</p>
<p>对二维码，我们是抱有美好的期待的，希望用户通过第三方SDK将二维码分享给好友，然后好友通过二维码调起App Clip，逻辑满分。但尴尬的是，App Clip的二维码，只能通过「系统相机」才能调起。我相信绝大部分的人看到二维码，第一反应都是拿微信去扫一扫，想要培养用户使用「系统相机」扫码的习惯恐怕很难。</p>
<p>那最后剩下的就是Safari这种方式了，这就需要我们想方设法的让用户在Safari里打开这个链接，注意，必须是Safari里打开，在第三方App里的WebView是没有办法显示Smart Banner的，自然也就没办法调起App Clip。</p>
</li>
</ol>
<h3 id="2-2-操作路径长"><a href="#2-2-操作路径长" class="headerlink" title="2.2 操作路径长"></a>2.2 操作路径长</h3><p>即便Safari貌似是纯线上App最适用的场景了，但是这种方式还存在一个问题，那就是用户的操作路径过长。以第三方分享为例，用户在第三方App接受到好友分享的链接后，打开Clip最短的操作路径可能如下：</p>
<ul>
<li>打开好友分享的链接，进入到内容页；</li>
<li>点击更多按钮，选择在Safari中打开；</li>
<li>点击Safari中Smart Banner上的Open按钮，调起Clip Card；</li>
<li>点击Clip Card上的Open按钮，调起App Clip；</li>
</ul>
<p>在引导用户通过Safari打开这步估计就足够劝退大部分的用户了…</p>
<h2 id="三：技术原因"><a href="#三：技术原因" class="headerlink" title="三：技术原因"></a>三：技术原因</h2><p>即便我们不考虑业务场景，单纯从技术角度看，实现一个App Clip本身恐怕也不会是一个轻松的过程。</p>
<ol>
<li><p>代码拆分</p>
<p>苹果希望App Clip和App提供一致的体验，刚看完WWDC的视频，一开始真的会给人一种实现一个App Clip 「So Easy」的感觉，只要复用原有的工程，随便勾勾选选，把文件加到Clip的Target下，一个精美小巧的App Clip就呈现在眼前了。</p>
<p>可事实上呢？通常我们需要尽可能复用现有的业务来开发Clip，可除非你所在的项目业务足够简单，或者组件化做的足够彻底，否则你会发现摘Clip的代码是一件几乎无法实现的事情，很可能需要先做大量的技术重构。当然你也可以将原有代码复制出来，重写一份，可是这样下来，为了保持与完整App的功能一致性，就需要付出维护两套代码的时间成本。</p>
</li>
<li><p>包大小限制</p>
<p>10M是App Clip包大小的上限，对于现在动辄一二百M的应用来说，如何用10M来完成目标功能，也是一个不小的挑战。一方面还是上面提到的代码拆分的问题，如果组件化时，基础层划分的颗粒度不够细致，很可能导致上层业务依赖的基础组件过多，从而影响包大小。另一方面，如果App Clip的功能一直是增量的，那必然会导致未来的某一天会超过10M的限制，为避免这一问题，还需要根据新增功能对包大小的影响，配合产品完成现有业务功能的调整。</p>
</li>
<li><p>后台活动</p>
<p>App Clip不支持后台处理活动，这里的后台活动不单指<code>beginBackgroundTaskWithExpirationHandler:</code>这种后台任务，经过实际测试，甚至连「正常的网络请求」以及「NSData转 NSString」等操作，在后台执行都是不是完全可靠的，再结合视频里说的：</p>
<blockquote>
<p>In addition, app Clip can’t perform background activity, such as doing background networking with URLSession or maintaining Bluetooth connections when the app clip isn’t in use.</p>
</blockquote>
<p>对于不能执行的<code>background activity</code>目前包括什么，咱无从得知，但从安全的角度看，尽量不在后台搞事情，肯定是第一原则，只是不知道把后台的监听都去掉，你的项目是否还能work~</p>
</li>
<li><p>唯一标识</p>
<p>如果想把App Clip当做拉新的手段，那可能就会涉及到一个问题：如果识别出当前App用户曾是App Clip用户？</p>
<p>我们知道如果用户手机上存在App Clip的情况下，又下载了对应的App，是可以进行数据迁移的。那如果用户的Clip因为一段时间未使用被系统自动删除了，此后用户又下载了App，该怎么设置用户的唯一标识呢？</p>
<p>要知道Clip在被系统删除时，也会清空其存储在Keychain中的数据，至于IDFA，Shared Keychain那就更别想了，Clip压根不开放这个能力。当然肯定还是有一些其他方式能够对用户进行唯一标识，比如有些防作弊的SDK，就可以标识唯一的设备ID，这就看大家各显神通了。当然，如果不关心这种case的话就另说了。</p>
</li>
<li><p>第三方App调起</p>
<p>App Clip可以通过Url Scheme或者Universal Link调起第三方App，但是第三方App却不能通过Url Scheme和Universal Link调起App Clip，说白了就是能调出去但是回不来。第三方登录、第三方分享、第三方支付可能都会受到影响。</p>
</li>
<li><p>不支持企业包</p>
<p>企业证书是没法配置App Clip的，如果项目是使用同一个工程，通过不同的configuration切换企业版和正式版，可能还需要注意一个额外的问题，App Clip是通过<code>Build Phases</code>中的<code>Embed App Clip</code>集成到主Target中的，而<code>Build Phases</code>又没办法区分configuration，如果想区分版本去添加<code>Embed App Clip</code>，就只能打企业包时，单独去修改Project文件了。</p>
</li>
<li><p>Pods</p>
<p>可能目前CocoaPods对App Clip的支持还不够完善，写Demo时发现如果App Clip需要依赖Pods的话，<code>pod install</code>后，在<code>Build Phases</code>中是不会自动生成<code>Embed Pods Frameworks</code>的，这就会导致编译时报<code>image not found</code>的错误，目前解决的办法就是手动添加一下<code>Embed Pods Frameworks</code>。</p>
</li>
</ol>
<h2 id="四：结语"><a href="#四：结语" class="headerlink" title="四：结语"></a>四：结语</h2><p>当然，对于App Clip的最终落地来说，技术原因终归是次要的，最关键还要看如何找到适合自己产品的业务场景。在苹果线上培训的时候，认识了一个团队的开发，说他们想用App Clip做AR，当时我就觉得这个想法还挺好的。可能对于很多产品来说没有这么新颖的玩法，其实倒也不必太在意，对于苹果来说他们也很清楚目前的现状，据他们自己说也在和美国总部沟通，当然结果如何，咱不得而知，但毕竟留个念想嘛，万一未来App Clip的入口放开了呢~</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">林辰</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">17</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">5</span>
        <span class="site-state-item-name">tags</span>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">林辰</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://mist.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Mist</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  


<script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//unpkg.com/valine/dist/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : false,
      appId      : 'kFJQFYlGcpqkKj9grbxdFeO3-gzGzoHsz',
      appKey     : 'cKBWWrkyrqclSn3x0gcqCNST',
      placeholder: "Just go go",
      avatar     : 'mm',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : true,
      lang       : '' || 'zh-cn',
      path       : location.pathname,
      recordIP   : false,
      serverURLs : ''
    });
  }, window.Valine);
});
</script>

</body>
</html>
